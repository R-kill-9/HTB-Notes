Authorization review focuses on verifying that users only have permissions to execute functions or access resources they are explicitly allowed to. Proper access control ensures that unauthorized users cannot exploit backend functionalities.

---

### **Key Points to Review**

1. **Role-Based Access Control (RBAC)**: Verify that roles are properly defined and enforced for each user action.
2. **Least Privilege Principle**: Ensure users and services have the minimum permissions necessary.
3. **Functionality Access**: Review APIs or backend endpoints to ensure they are protected from unauthorized access.
4. **Spring Security Policies**: If using **Spring Security**, confirm that the authorization rules are correctly configured.

---

### **Method-Level Authorization in Spring Security**

You can enforce fine-grained control at the method level using annotations:

- **`@PreAuthorize`**: Check permissions or roles before executing a method.
- **`@Secured`**: Restrict method access to specific roles.
- **`@RolesAllowed`**: An alternative to `@Secured` (from JSR 250).

```java
@PreAuthorize("hasRole('ADMIN')")
public void adminOnlyFunction() {
    // This function can only be executed by users with ADMIN role
}

@PreAuthorize("hasAnyRole('ADMIN', 'USER')")
public void userAndAdminFunction() {
    // Accessible to ADMIN or USER roles
}
```

## **Example of a bad Authorization Configuration**

In the following example, access to all sensitive endpoints is unintentionally left open:

```java
@Override
protected void configure(HttpSecurity http) throws Exception {
    http
        .authorizeRequests()
            .antMatchers("/admin/**").permitAll()  // Anyone can access admin endpoints
            .antMatchers("/user/**").permitAll()
            .anyRequest().authenticated();
}
```

- The `permitAll()` rule allows any user, authenticated or not, to access critical administrative functions.
- Attackers can exploit this misconfiguration to perform unauthorized operations.