Windows Kernel Exploits target vulnerabilities in the **Windows Kernel**, the core component of the operating system. These exploits typically lead to **privilege escalation**, where an attacker can gain higher system privileges (e.g., from a normal user to SYSTEM or Administrator).

## Windows Exploit Suggester
[Windows Exploit Suggester ](https://github.com/AonCyberLabs/Windows-Exploit-Suggester)(WES) is a tool designed to identifying missing patches and vulnerabilities in a Windows system. It compares the output from the `systeminfo` command, which details a system's patch level, against a Microsoft vulnerability database to find potential security gaps. This allows users to detect vulnerabilities that might still exist on a system even if it has been partially patched.

#### Usage
1. **Obtain the System Information**:

 Run the `systeminfo` command on the Windows machine you want to analyze. This command provides detailed information about the system, including patch levels. Save this output to a text file (e.g., `sysinfo.txt`).

2. **Download the Vulnerability Database**:

WES uses a Microsoft vulnerability database to compare the system information against known security issues. To download the database, run the command:

```bash
./windows-exploit-suggester.py --update
```

3. **Run WES Against the System Information**:

Once you have both the system information and the database, you can use WES to analyze the system. Run the following command, replacing `sysinfo.txt` and the downloaded database file:

```bash
./windows-exploit-suggester.py --database 2014-06-06-mssb.xlsx --systeminfo sysinfo.txt
```

## Windows-kernel-exploits
[windows-kernel-exploits](https://github.com/SecWiki/windows-kernel-exploits) is a collection of various exploits for the Windows kernel, providing multiple techniques for privilege escalation on the Windows platform. It serves as a resource for researchers and security professionals interested in Windows kernel vulnerabilities.

## Metasploit
Metasploit has various modules that can help us to escalate out privilege when we have gained access to a machine through Metasploit and we have obtained a meterpreter session.

#### local_exploit_suggester
1. **Use the Module**

```bash
use post/multi/recon/local_exploit_suggester
```

2. **Set the Session and run the module**

- Set the session number to the meterpreter session you are targeting (the session should have local access to the machine).

```bash
set SESSION <session_number>
run
```

3. **Analyze output**

- After running the module, you will see a list of potential exploits based on the analysis, such as:

```bash

[*] Collecting local exploits for x64/windows...
[*] 31 exploit checks are being tried...
[+] 10.10.10.7 - exploit/windows/local/bypassuac_dotnet_profiler: The target appears to be vulnerable.
[+] 10.10.10.7 - exploit/windows/local/bypassuac_sdclt: The target appears to be vulnerable.
[+] 10.10.10.7 - exploit/windows/local/cve_2019_1458_wizardopium: The target appears to be vulnerable.
```

The modules that have been appeared on the output can be used in msfconsole using `use <module>`. 